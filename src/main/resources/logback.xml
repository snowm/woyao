<?xml version="1.0" encoding="UTF-8"?>
<configuration debug="true" scan="true" scanPeriod="30 seconds">
	<appender name="STDOUT" class="ch.qos.logback.core.ConsoleAppender">
		<!-- encoders are by default assigned the type ch.qos.logback.classic.encoder.PatternLayoutEncoder -->
		<encoder>
			<pattern>%d{yyyy-MM-dd HH:mm:ss.SSS, GMT+8} [%-5level] [%thread] [%class:%line] - %m%n</pattern>

	        <!-- 常用的Pattern变量,大家可打开该pattern进行输出观察 -->
	        <!-- 
	          <pattern>
	              %d{yyyy-MM-dd HH:mm:ss} [%level] - %msg%n
	              Logger: %logger
	              Class: %class
	              File: %file
	              Caller: %caller
	              Line: %line
	              Message: %m
	              Method: %M
	              Relative: %relative
	              Thread: %thread
	              Exception: %ex
	              xException: %xEx
	              nopException: %nopex
	              rException: %rEx
	              Marker: %marker
	              %n
	              
	          </pattern>
	           -->
		</encoder>
		<!-- <timeZone>GMT+8</timeZone> -->
	</appender>

	<!-- 按日期区分的滚动日志 -->
	<appender name="ERROR-OUT"
		class="ch.qos.logback.core.rolling.RollingFileAppender">
		<file>${log.dir:-logs}/error.log</file>

		<encoder>
			<pattern>%d{yyyy-MM-dd HH:mm:ss.SSS, GMT+8} [%thread] [%class:%line] - %m%n</pattern>
		</encoder>

		<filter class="ch.qos.logback.classic.filter.LevelFilter">
			<level>ERROR</level>
			<onMatch>ACCEPT</onMatch>
			<onMismatch>DENY</onMismatch>
		</filter>

		<rollingPolicy class="ch.qos.logback.core.rolling.TimeBasedRollingPolicy">
			<!-- daily rollover -->
			<fileNamePattern>${log.dir:-logs}/error-%d{yyyy-MM-dd, GMT+8}.%i.log</fileNamePattern>

			<!-- keep 30 days' worth of history -->
			<!-- <maxHistory>30</maxHistory> -->
			<!-- or whenever the file size reaches 100MB -->
			<maxFileSize>100MB</maxFileSize>
		</rollingPolicy>
	</appender>

	<!-- 按日期和大小区分的滚动日志 -->
	<appender name="DEBUG-OUT"
		class="ch.qos.logback.core.rolling.RollingFileAppender">
		<file>${log.dir:-logs}/all.log</file>

		<encoder>
			<pattern>%d{yyyy-MM-dd HH:mm:ss.SSS, GMT+8} [%-5level] [%thread] [%class:%line] - %m%n</pattern>
		</encoder>

		<!-- <filter class="ch.qos.logback.classic.filter.LevelFilter">
			<level>DEBUG</level>
			<onMatch>ACCEPT</onMatch>
			<onMismatch>DENY</onMismatch>
		</filter> -->

		<rollingPolicy class="ch.qos.logback.core.rolling.TimeBasedRollingPolicy">
			<!-- rollover daily -->
			<fileNamePattern>${log.dir:-logs}/all-%d{yyyy-MM-dd, GMT+8}.%i.log</fileNamePattern>

			<timeBasedFileNamingAndTriggeringPolicy
				class="ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP">
				<!-- or whenever the file size reaches 100MB -->
				<maxFileSize>100MB</maxFileSize>
			</timeBasedFileNamingAndTriggeringPolicy>

		</rollingPolicy>

	</appender>

    <logger name="com.woyao">
        <level value="${log.level:-INFO}"/>
    </logger>
    <logger name="com.snowm">
        <level value="${log.level:-INFO}"/>
    </logger>
    <logger name="org.mortbay">
        <level value="ERROR"/>
    </logger>
    <logger name="httpclient.wire">
        <level value="WARN"/>
    </logger>
    <logger name="java">
        <level value="WARN"/>
    </logger>
    <logger name="org.springframework">
        <level value="WARN"/>
    </logger>
    <logger name="org.hibernate">
        <level value="WARN"/>
    </logger>

    <!-- General Catch All -->
    <logger name="edu">
        <level value="WARN"/>
    </logger>
    <logger name="net">
        <level value="WARN"/>
    </logger>
    <logger name="io.netty">
        <level value="WARN"/>
    </logger>
    
    <!-- security -->
    <logger name="org.glassfish.jersey.logging.LoggingInterceptor">
        <level value="${log.level:-INFO}"/>
    </logger>
    <logger name="com.woyao.security.Oauth2SecurityFilter">
    	<level value="${log.level:-INFO}"/>
    </logger>

    <!-- ======================= -->
    <!-- Setup the Root category -->
    <!-- ======================= -->

    <root>
        <level value="${log.level:-INFO}"/>
        
		<appender-ref ref="STDOUT" />
		<appender-ref ref="ERROR-OUT" />
		<appender-ref ref="DEBUG-OUT" />
    </root>
</configuration>